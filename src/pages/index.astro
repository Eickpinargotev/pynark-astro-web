---
import Layout from '../layouts/Layout.astro';
import ChatSimulation from '../components/ChatSimulation.tsx';
// Nota: se eliminó el chat de prueba. Mantenemos solo los componentes necesarios.
---

<Layout title="Pynark Automation - Chatbots que Convierten">
  <!-- Hero Section -->
  <section class="py-20 px-4 sm:px-6 lg:px-8">
    <div class="max-w-7xl mx-auto text-center">
      <h1 class="font-display text-4xl sm:text-5xl lg:text-6xl font-bold text-slate-900 dark:text-white mb-6">
        Chatbots que convierten <br class="hidden sm:block">
        <span class="bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent">
          visitas en ventas y citas
        </span>
      </h1>
      <p class="text-xl text-slate-600 dark:text-slate-300 mb-12 max-w-3xl mx-auto">
        Especialistas en agentes de servicio al cliente que funcionan 24/7 para hacer crecer tu negocio.
      </p>
    </div>
  </section>

  <!-- Servicios Section -->
  <section id="servicios" class="py-20 px-4 sm:px-6 lg:px-8 scroll-mt-24 bg-gradient-to-br from-primary-50/50 to-secondary-50/40 dark:from-primary-900/10 dark:to-secondary-900/10">
    <div class="max-w-7xl mx-auto">
      <div class="text-center mb-14">
        <h2 class="font-display text-3xl sm:text-4xl font-bold text-slate-900 dark:text-white mb-3">
          Lo que hacemos en Pynark Automation
        </h2>
        <p class="text-slate-600 dark:text-slate-300 max-w-3xl mx-auto">
          Arquitectura, agentes y automatización conectados a tus canales y datos.
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
        <!-- Card: Infraestructura de IA autónoma -->
        <article class="group relative overflow-hidden rounded-3xl border border-slate-200/70 dark:border-slate-700/60 bg-white/70 dark:bg-slate-800/70 shadow-lg hover:shadow-xl transition-all">
          <div class="absolute -top-12 -right-12 w-40 h-40 rounded-full bg-gradient-to-br from-primary-500/20 to-secondary-500/20 blur-2xl"></div>
          <div class="p-7">
            <div class="flex items-center gap-3">
              <div class="text-3xl">🧠</div>
              <h3 class="font-display text-xl font-semibold text-slate-900 dark:text-white">Infraestructura de IA autónoma</h3>
            </div>
            <ul class="mt-4 space-y-3 text-slate-600 dark:text-slate-300">
              <li class="flex gap-3"><span class="mt-1">⚙️</span><span>Diseño e implementación de agentes orquestados, colas de tareas, logs y monitoreo.</span></li>
              <li class="flex gap-3"><span class="mt-1">🔗</span><span>CRM a tu elección: Integración con HubSpot, Salesforce, Zoho, etc., con sincronización bidireccional de contactos, deals y actividades.</span></li>
              <li class="flex gap-3"><span class="mt-1">💬</span><span>Soporte multicanal: WhatsApp, Instagram, Facebook y Telegram en una sola capa conversacional.</span></li>
              <li class="flex gap-3"><span class="mt-1">🗄️</span><span>Base de datos y gobierno del dato: Modelado, limpieza y accesos seguros para alimentar a tus agentes y reportes.</span></li>
            </ul>
          </div>
          <div class="pointer-events-none absolute left-0 right-0 bottom-0 h-[3px] bg-gradient-to-r from-primary-500 to-secondary-500 scale-x-0 group-hover:scale-x-100 origin-left transition-transform"></div>
        </article>

        <!-- Card: Agentes de IA que responden 24/7 -->
        <article class="group relative overflow-hidden rounded-3xl border border-slate-200/70 dark:border-slate-700/60 bg-white/70 dark:bg-slate-800/70 shadow-lg hover:shadow-xl transition-all">
          <div class="absolute -top-12 -right-12 w-40 h-40 rounded-full bg-gradient-to-br from-emerald-500/20 to-teal-500/20 blur-2xl"></div>
          <div class="p-7">
            <div class="flex items-center gap-3">
              <div class="text-3xl">🤖</div>
              <h3 class="font-display text-xl font-semibold text-slate-900 dark:text-white">Agentes de IA que responden 24/7</h3>
            </div>
            <ul class="mt-4 space-y-3 text-slate-600 dark:text-slate-300">
              <li class="flex gap-3"><span class="mt-1">🎧</span><span>Atención al cliente automatizada with respuestas naturales, precisas y consistentes, y handoff a humano cuando haga falta.</span></li>
              <li class="flex gap-3"><span class="mt-1">📚</span><span>Conocimiento actualizado: conexión a FAQs, catálogo, políticas y documentos internos.</span></li>
              <li class="flex gap-3"><span class="mt-1">✨</span><span>Control de tono y marca: personalidad configurable para mantener tu identidad.</span></li>
            </ul>
          </div>
          <div class="pointer-events-none absolute left-0 right-0 bottom-0 h-[3px] bg-gradient-to-r from-emerald-500 to-teal-500 scale-x-0 group-hover:scale-x-100 origin-left transition-transform"></div>
        </article>

        <!-- Card: Automatización con n8n -->
        <article class="group relative overflow-hidden rounded-3xl border border-slate-200/70 dark:border-slate-700/60 bg-white/70 dark:bg-slate-800/70 shadow-lg hover:shadow-xl transition-all">
          <div class="absolute -top-12 -right-12 w-40 h-40 rounded-full bg-gradient-to-br from-amber-500/20 to-orange-500/20 blur-2xl"></div>
          <div class="p-7">
            <div class="flex items-center gap-3">
              <div class="text-3xl">🕸️</div>
              <h3 class="font-display text-xl font-semibold text-slate-900 dark:text-white">Automatización con n8n</h3>
            </div>
            <ul class="mt-4 space-y-3 text-slate-600 dark:text-slate-300">
              <li class="flex gap-3"><span class="mt-1">🔁</span><span>Workflows operativos: automatización de tareas repetitivas (altas/bajas, validaciones, disparadores por evento).</span></li>
              <li class="flex gap-3"><span class="mt-1">🧩</span><span>Integración total: conectores con ERP, CRM, pasarelas de pago, formularios y calendarios.</span></li>
              <li class="flex gap-3"><span class="mt-1">🛡️</span><span>Orquestación avanzada: ramas condicionales, manejo de errores, reintentos y alertas.</span></li>
            </ul>
          </div>
          <div class="pointer-events-none absolute left-0 right-0 bottom-0 h-[3px] bg-gradient-to-r from-amber-500 to-orange-500 scale-x-0 group-hover:scale-x-100 origin-left transition-transform"></div>
        </article>

        <!-- Card: Automatización de ventas -->
        <article class="group relative overflow-hidden rounded-3xl border border-slate-200/70 dark:border-slate-700/60 bg-white/70 dark:bg-slate-800/70 shadow-lg hover:shadow-xl transition-all">
          <div class="absolute -top-12 -right-12 w-40 h-40 rounded-full bg-gradient-to-br from-fuchsia-500/20 to-violet-500/20 blur-2xl"></div>
          <div class="p-7">
            <div class="flex items-center gap-3">
              <div class="text-3xl">💼</div>
              <h3 class="font-display text-xl font-semibold text-slate-900 dark:text-white">Automatización de ventas</h3>
            </div>
            <ul class="mt-4 space-y-3 text-slate-600 dark:text-slate-300">
              <li class="flex gap-3"><span class="mt-1">🧲</span><span>Gestión de leads: captura, scoring y enrutamiento automático.</span></li>
              <li class="flex gap-3"><span class="mt-1">📨</span><span>Nurturing y seguimiento: secuencias por email y WhatsApp, recordatorios y tareas para tu equipo comercial.</span></li>
              <li class="flex gap-3"><span class="mt-1">📅</span><span>Citas y demos: agendado automático con confirmaciones y recordatorios.</span></li>
            </ul>
          </div>
          <div class="pointer-events-none absolute left-0 right-0 bottom-0 h-[3px] bg-gradient-to-r from-fuchsia-500 to-violet-500 scale-x-0 group-hover:scale-x-100 origin-left transition-transform"></div>
        </article>

        <!-- Card: Analítica, Dashboards & KPIs -->
        <article class="group relative overflow-hidden rounded-3xl border border-slate-200/70 dark:border-slate-700/60 bg-white/70 dark:bg-slate-800/70 shadow-lg hover:shadow-xl transition-all xl:col-span-2">
          <div class="absolute -top-12 -right-12 w-40 h-40 rounded-full bg-gradient-to-br from-sky-500/20 to-cyan-500/20 blur-2xl"></div>
          <div class="p-7">
            <div class="flex items-center gap-3">
              <div class="text-3xl">📊</div>
              <h3 class="font-display text-xl font-semibold text-slate-900 dark:text-white">Analítica, Dashboards & KPIs</h3>
            </div>
            <ul class="mt-4 space-y-3 text-slate-600 dark:text-slate-300">
              <li class="flex gap-3"><span class="mt-1">⏱️</span><span>Dashboards en tiempo real: métricas clave de atención, conversión, ventas y satisfacción.</span></li>
              <li class="flex gap-3"><span class="mt-1">📬</span><span>Reportes automáticos: envío programado con insights accionables.</span></li>
              <li class="flex gap-3"><span class="mt-1">🧪</span><span>Optimización continua: A/B testing de flujos, prompts y secuencias para mejorar conversiones.</span></li>
            </ul>
          </div>
          <div class="pointer-events-none absolute left-0 right-0 bottom-0 h-[3px] bg-gradient-to-r from-sky-500 to-cyan-500 scale-x-0 group-hover:scale-x-100 origin-left transition-transform"></div>
        </article>
      </div>
    </div>
  </section>

  <!-- How We Work Section (rediseño con emojis) -->
  <section id="proceso" class="py-20 px-4 sm:px-6 lg:px-8 scroll-mt-24">
    <div class="max-w-7xl mx-auto">
      <div class="text-center mb-16">
        <h2 class="font-display text-3xl sm:text-4xl font-bold text-slate-900 dark:text-white mb-3">
          ¿Cómo trabajamos?
        </h2>
        <p class="text-slate-600 dark:text-slate-300 max-w-3xl mx-auto">
          Un proceso claro y estructurado para garantizar el éxito de tu automatización
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
        <!-- Card 1 -->
        <div class="group relative bg-white dark:bg-slate-800 rounded-3xl p-8 shadow-lg border border-slate-200 dark:border-slate-700 hover:shadow-xl transition-all text-center md:text-left">
          <div class="absolute -top-5 left-1/2 -translate-x-1/2 md:left-8 md:translate-x-0">
            <div class="w-14 h-14 rounded-full bg-gradient-to-r from-primary-600 to-secondary-600 flex items-center justify-center text-2xl shadow-lg">
              <span class="text-white font-bold">1</span>
            </div>
          </div>
          <div class="mt-6 text-5xl mx-auto md:mx-0">🛠️</div>
          <p class="mt-2 text-xs font-medium text-slate-500 dark:text-slate-400">Paso 1/4</p>
          <h3 class="mt-3 font-display text-xl font-semibold text-slate-900 dark:text-white">
            Diagnóstico
          </h3>
          <p class="mt-2 text-slate-600 dark:text-slate-300">
            Sesión de 30-45 minutos para entender tu negocio y necesidades específicas
          </p>
        </div>

        <!-- Card 2 -->
        <div class="group relative bg-white dark:bg-slate-800 rounded-3xl p-8 shadow-lg border border-slate-200 dark:border-slate-700 hover:shadow-xl transition-all text-center md:text-left">
          <div class="absolute -top-5 left-1/2 -translate-x-1/2 md:left-8 md:translate-x-0">
            <div class="w-14 h-14 rounded-full bg-gradient-to-r from-primary-600 to-secondary-600 flex items-center justify-center text-2xl shadow-lg">
              <span class="text-white font-bold">2</span>
            </div>
          </div>
          <div class="mt-6 text-5xl mx-auto md:mx-0">🤖</div>
          <p class="mt-2 text-xs font-medium text-slate-500 dark:text-slate-400">Paso 2/4</p>
          <h3 class="mt-3 font-display text-xl font-semibold text-slate-900 dark:text-white">
            Setup de vertical
          </h3>
          <p class="mt-2 text-slate-600 dark:text-slate-300">
            Configuración personalizada del agente en 2-5 días según tu industria
          </p>
        </div>

        <!-- Card 3 -->
        <div class="group relative bg-white dark:bg-slate-800 rounded-3xl p-8 shadow-lg border border-slate-200 dark:border-slate-700 hover:shadow-xl transition-all text-center md:text-left">
          <div class="absolute -top-5 left-1/2 -translate-x-1/2 md:left-8 md:translate-x-0">
            <div class="w-14 h-14 rounded-full bg-gradient-to-r from-primary-600 to-secondary-600 flex items-center justify-center text-2xl shadow-lg">
              <span class="text-white font-bold">3</span>
            </div>
          </div>
          <div class="mt-6 text-5xl mx-auto md:mx-0">🧪</div>
          <p class="mt-2 text-xs font-medium text-slate-500 dark:text-slate-400">Paso 3/4</p>
          <h3 class="mt-3 font-display text-xl font-semibold text-slate-900 dark:text-white">
            Go-live con monitoreo
          </h3>
          <p class="mt-2 text-slate-600 dark:text-slate-300">
            Lanzamiento con supervisión activa para garantizar el rendimiento óptimo
          </p>
        </div>

        <!-- Card 4 -->
        <div class="group relative bg-white dark:bg-slate-800 rounded-3xl p-8 shadow-lg border border-slate-200 dark:border-slate-700 hover:shadow-xl transition-all text-center md:text-left">
          <div class="absolute -top-5 left-1/2 -translate-x-1/2 md:left-8 md:translate-x-0">
            <div class="w-14 h-14 rounded-full bg-gradient-to-r from-primary-600 to-secondary-600 flex items-center justify-center text-2xl shadow-lg">
              <span class="text-white font-bold">4</span>
            </div>
          </div>
          <div class="mt-6 text-5xl mx-auto md:mx-0">🚀</div>
          <p class="mt-2 text-xs font-medium text-slate-500 dark:text-slate-400">Paso 4/4</p>
          <h3 class="mt-3 font-display text-xl font-semibold text-slate-900 dark:text-white">
            Optimización mensual
          </h3>
          <p class="mt-2 text-slate-600 dark:text-slate-300">
            Reportes detallados con insights y mejoras continuas del rendimiento
          </p>
        </div>
      </div>

      <!-- CTA under process section -->
      <div class="mt-12 text-center">
        <a href="/#contact" class="inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-primary-600 to-secondary-600 hover:from-primary-700 hover:to-secondary-700 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300">
          Comenzar diagnóstico
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
        </a>
      </div>
    </div>
  </section>

  <!-- Examples Section -->
  <section class="py-20 px-4 sm:px-6 lg:px-8 bg-gradient-to-br from-slate-50 to-primary-50/30 dark:from-slate-900 dark:to-primary-900/10">
    <div class="max-w-7xl mx-auto">
      <div class="text-center mb-16">
        <h2 class="font-display text-3xl sm:text-4xl font-bold text-slate-900 dark:text-white mb-6">
          Ejemplos en acción
        </h2>
        <p class="text-xl text-slate-600 dark:text-slate-300 max-w-3xl mx-auto">
          Descubre cómo nuestros agentes manejan diferentes situaciones reales de negocio
        </p>
      </div>
      
      <ChatSimulation client:load />
    </div>
  </section>

  <!-- Contact Section -->
  <section id="contact" class="py-20 px-4 sm:px-6 lg:px-8">
    <div class="max-w-4xl mx-auto">
      <div class="text-center mb-12">
        <h2 class="font-display text-3xl sm:text-4xl font-bold text-slate-900 dark:text-white mb-6">
          Contáctanos
        </h2>
        <p class="text-xl text-slate-600 dark:text-slate-300">
          ¿Listo para transformar tu atención al cliente? Hablemos
        </p>
      </div>
      
      <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-xl border border-slate-200 dark:border-slate-700 p-8">
  <form id="contact-form" class="space-y-6" novalidate action="https://paneln8n.erickpinargote.com/webhook/contacto_pynark" method="POST">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="name" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
                Nombre
              </label>
              <div class="relative rounded-xl p-[2px] bg-gradient-to-r from-primary-500 to-secondary-500 shadow-sm group focus-within:shadow-md transition-all">
                <input
                  type="text"
                  id="name"
                  name="name"
                  required
                  class="w-full rounded-xl bg-white/95 dark:bg-slate-800/90 backdrop-blur pl-12 pr-4 py-3 border-0 text-slate-900 dark:text-slate-100 placeholder-slate-500 dark:placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-primary-500/80"
                  placeholder="Tu nombre completo"
                />
                <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 dark:text-slate-400" aria-hidden="true">
                  <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                </span>
              </div>
            </div>
            <div>
              <label for="email" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
                Email
              </label>
              <div class="relative rounded-xl p-[2px] bg-gradient-to-r from-primary-500 to-secondary-500 shadow-sm group focus-within:shadow-md transition-all">
                <input
                  type="email"
                  id="email"
                  name="email"
                  required
                  class="w-full rounded-xl bg-white/95 dark:bg-slate-800/90 backdrop-blur pl-12 pr-4 py-3 border-0 text-slate-900 dark:text-slate-100 placeholder-slate-500 dark:placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-primary-500/80"
                  placeholder="tu@email.com"
                />
                <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 dark:text-slate-400" aria-hidden="true">
                  <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16v16H4z" opacity="0"/><path d="M4 8l8 5 8-5"/><rect x="4" y="4" width="16" height="16" rx="2"/></svg>
                </span>
              </div>
            </div>
            <div>
              <label for="phone" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
                Teléfono
              </label>
              <div class="relative rounded-xl p-[2px] bg-gradient-to-r from-primary-500 to-secondary-500 shadow-sm group focus-within:shadow-md transition-all">
                <input
                  type="tel"
                  id="phone"
                  name="phone"
                  required
                  inputmode="tel"
                  autocomplete="tel"
                  class="w-full rounded-xl bg-white/95 dark:bg-slate-800/90 backdrop-blur pl-12 pr-4 py-3 border-0 text-slate-900 dark:text-slate-100 placeholder-slate-500 dark:placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-primary-500/80"
                  placeholder="Ej: +593 99 999 9999"
                />
                <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 dark:text-slate-400" aria-hidden="true">
                  <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2A19.74 19.74 0 0 1 3.08 5.18 2 2 0 0 1 5 3h3a2 2 0 0 1 2 1.72 12.44 12.44 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L9 10a16 16 0 0 0 5 5l.36-.25a2 2 0 0 1 2.11-.45 12.44 12.44 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
                </span>
              </div>
            </div>
            <div>
              <label for="plan-trigger" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
                Plan de interés
              </label>
              <!-- Custom Select: stores value in hidden input name=plan -->
              <div class="relative" data-plan-select>
                <input type="hidden" id="plan" name="plan" value="" />
                <div class="rounded-xl p-[2px] bg-gradient-to-r from-primary-500 to-secondary-500 shadow-sm group focus-within:shadow-md transition-all">
                  <button type="button" id="plan-trigger" data-trigger aria-haspopup="listbox" aria-expanded="false"
                    class="relative w-full rounded-xl bg-white/95 dark:bg-slate-800/90 backdrop-blur px-12 pr-12 py-3 text-left text-slate-900 dark:text-slate-100 shadow-inner focus:outline-none focus:ring-2 focus:ring-primary-500/80"
                  >
                    <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 dark:text-slate-400" aria-hidden="true">
                      <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2l7 4-7 4-7-4 7-4z"/><path d="M19 10l-7 4-7-4"/><path d="M19 16l-7 4-7-4"/></svg>
                    </span>
                    <span data-label class="block truncate text-slate-600 dark:text-slate-300">Selecciona un plan</span>
                    <span class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 dark:text-slate-400" aria-hidden="true">
                      <svg data-chevron class="w-5 h-5 transition-transform" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
                    </span>
                  </button>
                </div>

                <ul data-listbox role="listbox" tabindex="-1"
                  class="invisible opacity-0 pointer-events-none absolute z-20 mt-2 w-full rounded-xl border border-slate-200 dark:border-slate-700 bg-white/95 dark:bg-slate-900/95 backdrop-blur shadow-xl ring-1 ring-black/5 dark:ring-white/10 divide-y divide-slate-100/60 dark:divide-slate-800/80 transition-[opacity,transform,visibility] duration-150 origin-top scale-95"
                >
                  <li role="option" data-value="starter" class="cursor-pointer px-4 py-2.5 text-sm text-slate-800 dark:text-slate-200 hover:bg-primary-50 dark:hover:bg-slate-800/60 flex items-center justify-between">
                    <span>Starter</span>
                    <svg class="w-4 h-4 text-primary-600 opacity-0" data-check aria-hidden="true" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6L9 17l-5-5"/></svg>
                  </li>
                  <li role="option" data-value="pro" class="cursor-pointer px-4 py-2.5 text-sm text-slate-800 dark:text-slate-200 hover:bg-primary-50 dark:hover:bg-slate-800/60 flex items-center justify-between">
                    <span>Pro</span>
                    <svg class="w-4 h-4 text-primary-600 opacity-0" data-check aria-hidden="true" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6L9 17l-5-5"/></svg>
                  </li>
                  <li role="option" data-value="ultra" class="cursor-pointer px-4 py-2.5 text-sm text-slate-800 dark:text-slate-200 hover:bg-primary-50 dark:hover:bg-slate-800/60 flex items-center justify-between">
                    <span>Ultra</span>
                    <svg class="w-4 h-4 text-primary-600 opacity-0" data-check aria-hidden="true" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6L9 17l-5-5"/></svg>
                  </li>
                  <li role="option" data-value="custom" class="cursor-pointer px-4 py-2.5 text-sm text-slate-800 dark:text-slate-200 hover:bg-primary-50 dark:hover:bg-slate-800/60 flex items-center justify-between rounded-b-xl">
                    <span>Personalizado</span>
                    <svg class="w-4 h-4 text-primary-600 opacity-0" data-check aria-hidden="true" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6L9 17l-5-5"/></svg>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          
          <div>
            <label for="company" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
              Empresa
            </label>
            <div class="relative rounded-xl p-[2px] bg-gradient-to-r from-primary-500 to-secondary-500 shadow-sm group focus-within:shadow-md transition-all">
              <input
                type="text"
                id="company"
                name="company"
                class="w-full rounded-xl bg-white/95 dark:bg-slate-800/90 backdrop-blur pl-12 pr-4 py-3 border-0 text-slate-900 dark:text-slate-100 placeholder-slate-500 dark:placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-primary-500/80"
                placeholder="Nombre de tu empresa"
              />
              <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 dark:text-slate-400" aria-hidden="true">
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><path d="M3 9h18"/><path d="M9 21V9"/></svg>
              </span>
            </div>
          </div>
          
          <div>
            <label for="message" class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
              Mensaje
            </label>
            <div class="relative rounded-xl p-[2px] bg-gradient-to-r from-primary-500 to-secondary-500 shadow-sm group focus-within:shadow-md transition-all">
              <textarea
                id="message"
                name="message"
                rows="4"
                required
                class="w-full rounded-xl bg-white/95 dark:bg-slate-800/90 backdrop-blur pl-12 pr-4 py-3 border-0 text-slate-900 dark:text-slate-100 placeholder-slate-500 dark:placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-primary-500/80 resize-none"
                placeholder="Cuéntanos sobre tu proyecto y cómo podemos ayudarte..."
              ></textarea>
              <span class="absolute left-3 top-3 text-slate-500 dark:text-slate-400" aria-hidden="true">
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
              </span>
            </div>
          </div>
          
          <div class="space-y-4">
            <div id="contact-status" class="text-sm" aria-live="polite"></div>
            <button
              id="contact-submit"
              type="submit"
              class="w-full px-8 py-4 bg-gradient-to-r from-primary-600 to-secondary-600 hover:from-primary-700 hover:to-secondary-700 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 disabled:opacity-60 disabled:cursor-not-allowed"
            >
              Enviar mensaje
            </button>
          </div>
        </form>
      </div>
    </div>
  </section>

  <script>
    // Prevent initial unwanted scroll
    document.addEventListener('DOMContentLoaded', () => {
      // Reset scroll position if no specific hash is intended
      if (!window.location.hash || window.location.hash === '#') {
        window.scrollTo(0, 0);
      }
    });
    // Scripts del formulario de contacto
  // --- Contact form submission to n8n webhook ---
  (function initContactForm(){
    const form = document.getElementById('contact-form') as HTMLFormElement | null;
    if(!form) return;
    const statusEl = document.getElementById('contact-status') as HTMLElement | null;
    const submitBtn = document.getElementById('contact-submit') as HTMLButtonElement | null;
    const WEBHOOK_URL = 'https://paneln8n.erickpinargote.com/webhook/contacto_pynark';

    // Custom dropdown wiring (value sync to hidden input#plan)
    const planWrap = document.querySelector('[data-plan-select]') as HTMLElement | null;
    const planHidden = document.getElementById('plan') as HTMLInputElement | null;
    const trigger = planWrap?.querySelector('[data-trigger]') as HTMLButtonElement | null;
    const label = planWrap?.querySelector('[data-label]') as HTMLElement | null;
    const chevron = planWrap?.querySelector('[data-chevron]') as SVGElement | null;
    const listbox = planWrap?.querySelector('[data-listbox]') as HTMLUListElement | null;
    const options = Array.from(listbox?.querySelectorAll('[role="option"]') ?? []) as HTMLLIElement[];

    function openList() {
      if(!listbox || !trigger) return;
      listbox.classList.remove('invisible','pointer-events-none');
      listbox.classList.remove('opacity-0');
      (listbox as HTMLUListElement).style.transform = 'scale(1)';
      listbox.classList.add('opacity-100');
      trigger.setAttribute('aria-expanded','true');
      chevron?.classList.add('rotate-180');
    }
    function closeList() {
      if(!listbox || !trigger) return;
      listbox.classList.add('opacity-0');
      listbox.classList.remove('opacity-100');
      (listbox as HTMLUListElement).style.transform = 'scale(0.95)';
      trigger.setAttribute('aria-expanded','false');
      chevron?.classList.remove('rotate-180');
      // Defer visibility after transition
      setTimeout(()=>{
        listbox.classList.add('invisible','pointer-events-none');
      }, 120);
    }
    function setPlan(val: string, text?: string) {
      if(!planHidden || !label) return;
      (planHidden as HTMLInputElement).value = val;
      (label as HTMLElement).textContent = text || (val.charAt(0).toUpperCase()+val.slice(1));
      // Visual mark
      const wrapper = planWrap?.querySelector('.rounded-xl.p-\\[2px\\]') as HTMLElement | null;
      if(wrapper){
        wrapper.classList.add('ring-2','ring-primary-500/70');
        setTimeout(()=> wrapper.classList.remove('ring-2','ring-primary-500/70'), 1000);
      }
      // toggle checks
      options.forEach(li => {
        const v = li.getAttribute('data-value');
        const check = li.querySelector('[data-check]') as SVGElement | null;
        if(check){ check.style.opacity = v === val ? '1' : '0'; }
        li.classList.toggle('bg-primary-50', v === val);
        li.classList.toggle('dark:bg-slate-800/60', v === val);
      });
    }

    // Events
    trigger?.addEventListener('click', (e) => {
      e.preventDefault();
      const expanded = trigger.getAttribute('aria-expanded') === 'true';
      expanded ? closeList() : openList();
    });
    options.forEach(li => {
      li.addEventListener('click', () => {
        const v = li.getAttribute('data-value') || '';
        const t = (li.querySelector('span')?.textContent || '').trim();
        setPlan(v, t);
        closeList();
        trigger?.focus();
      });
    });
    document.addEventListener('click', (ev) => {
      if(!planWrap) return;
      const target = ev.target as Node;
      if(!planWrap.contains(target)) closeList();
    });
    trigger?.addEventListener('keydown', (e: KeyboardEvent) => {
      if(e.key === 'ArrowDown' || e.key === 'Enter' || e.key === ' '){
        e.preventDefault();
        openList();
        (options[0] as HTMLElement)?.focus();
      }
    });
    options.forEach((li, idx) => {
      (li as HTMLLIElement).tabIndex = -1;
      li.addEventListener('keydown', (e: KeyboardEvent) => {
        if(e.key === 'Escape'){ e.preventDefault(); closeList(); trigger?.focus(); }
        if(e.key === 'ArrowDown'){ e.preventDefault(); (options[idx+1]||options[0]) && (options[idx+1]||options[0] as any)?.focus?.(); }
        if(e.key === 'ArrowUp'){ e.preventDefault(); (options[idx-1]||options[options.length-1]) && (options[idx-1]||options[options.length-1] as any)?.focus?.(); }
        if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); (li as HTMLElement).click(); }
      });
    });

    // Preselección de plan por URL (?plan=starter|pro|ultra|custom)
    try {
      const usp = new URLSearchParams(window.location.search);
      const qplan = (usp.get('plan')||'').toLowerCase();
      const allowed = new Set(['starter','pro','ultra','custom']);
      if(planHidden && allowed.has(qplan)){
        const li = options.find(o => o.getAttribute('data-value') === qplan);
        const t = (li?.querySelector('span')?.textContent || '').trim();
        setPlan(qplan, t);
      }
    } catch {}

    // Optional simple honeypot
    if(!form.querySelector('[name="_hp"]')){
      const hp = document.createElement('input');
      hp.type = 'text';
      hp.name = '_hp';
      hp.tabIndex = -1;
      hp.autocomplete = 'off';
      hp.style.position = 'absolute';
      hp.style.left = '-9999px';
      form.appendChild(hp);
    }

    const setStatus = (msg: string, type: 'info'|'success'|'error') => {
      if(!statusEl) return;
      const base = 'px-4 py-3 rounded-lg border text-sm font-medium';
      const styles: Record<'info'|'success'|'error', string> = {
        info: 'bg-slate-100 dark:bg-slate-700/50 text-slate-700 dark:text-slate-200 border-slate-300 dark:border-slate-600',
        success: 'bg-emerald-100 dark:bg-emerald-900/30 text-emerald-800 dark:text-emerald-200 border-emerald-300 dark:border-emerald-700',
        error: 'bg-rose-100 dark:bg-rose-900/30 text-rose-800 dark:text-rose-200 border-rose-300 dark:border-rose-700'
      };
      (statusEl as HTMLElement).className = base + ' ' + styles[type];
      (statusEl as HTMLElement).textContent = msg;
    };

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      if(submitBtn?.disabled) return; // prevent double
      const formData = new FormData(form as HTMLFormElement);
      // Honeypot detection
      if((formData.get('_hp') as string)?.toString().trim().length){
        setStatus('Enviado', 'success'); // Pretend success to bots
        return;
      }
      const name = (formData.get('name')||'').toString().trim();
      const email = (formData.get('email')||'').toString().trim();
      const phone = (formData.get('phone')||'').toString().trim();
      const company = (formData.get('company')||'').toString().trim();
      const plan = (formData.get('plan')||'').toString().trim();
      const message = (formData.get('message')||'').toString().trim();

      if(!name || !email || !phone || !plan || !message){
        setStatus('Por favor completa los campos requeridos.', 'error');
        return;
      }

      const payload = {
        name,
        email,
        phone,
        plan,
        company: company || null,
        message,
        submitted_at: new Date().toISOString(),
        source: 'website_contact_form',
        user_agent: navigator.userAgent
      };

      try {
        submitBtn && ((submitBtn as HTMLButtonElement).disabled = true);
        setStatus('Enviando tu mensaje...', 'info');
        const resp = await fetch(WEBHOOK_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        if(!resp.ok){
          throw new Error('Status ' + resp.status);
        }
        setStatus('¡Mensaje enviado! Te contactaremos muy pronto.', 'success');
        (form as HTMLFormElement).reset();
        // Foco accesible
        setTimeout(() => { statusEl?.scrollIntoView({behavior:'smooth', block:'center'}); }, 50);
      } catch(err){
        console.error('Error enviando formulario', err);
        setStatus('No se pudo enviar. Intenta nuevamente en unos segundos.', 'error');
      } finally {
        submitBtn && ((submitBtn as HTMLButtonElement).disabled = false);
      }
    });
  })();
  </script>

  <style>
    @keyframes fade-in {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .animate-fade-in {
      animation: fade-in 0.5s ease-out forwards;
    }
    
  </style>
</Layout>
